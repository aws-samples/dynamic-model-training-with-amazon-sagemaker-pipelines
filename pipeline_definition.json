{"Version": "2020-12-01", "Metadata": {}, "Parameters": [], "PipelineExperimentConfig": {"ExperimentName": {"Get": "Execution.PipelineName"}, "TrialName": {"Get": "Execution.PipelineExecutionId"}}, "Steps": [{"Name": "falcon-text-summarization-preprocess", "Type": "Processing", "Arguments": {"ProcessingResources": {"ClusterConfig": {"InstanceType": "ml.m5.2xlarge", "InstanceCount": 1, "VolumeSizeInGB": 32}}, "AppSpecification": {"ImageUri": "763104351884.dkr.ecr.us-east-1.amazonaws.com/pytorch-training:2.0.0-cpu-py310-ubuntu20.04-sagemaker", "ContainerEntrypoint": ["/bin/bash", "/opt/ml/processing/input/entrypoint/runproc.sh"]}, "RoleArn": "arn:aws:iam::327206644775:role/service-role/AmazonSageMaker-ExecutionRole-20221003T003950", "ProcessingInputs": [{"InputName": "code", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-us-east-1-327206644775/calhousing-test/code/10162a72a70ea73cfc521c8d9a940a1e/sourcedir.tar.gz", "LocalPath": "/opt/ml/processing/input/code/", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "entrypoint", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-us-east-1-327206644775/calhousing-test/code/b99be1bf860d1dd9ef0da2f5e99d6005/runproc.sh", "LocalPath": "/opt/ml/processing/input/entrypoint", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}], "ProcessingOutputConfig": {"Outputs": [{"OutputName": "training", "AppManaged": false, "S3Output": {"S3Uri": {"Std:Join": {"On": "/", "Values": ["s3:/", "sagemaker-us-east-1-327206644775", "calhousing-test", {"Get": "Execution.PipelineExecutionId"}, "falcon-text-summarization-preprocess", "output", "training"]}}, "LocalPath": "/opt/ml/processing/output/training", "S3UploadMode": "EndOfJob"}}, {"OutputName": "testing", "AppManaged": false, "S3Output": {"S3Uri": {"Std:Join": {"On": "/", "Values": ["s3:/", "sagemaker-us-east-1-327206644775", "calhousing-test", {"Get": "Execution.PipelineExecutionId"}, "falcon-text-summarization-preprocess", "output", "testing"]}}, "LocalPath": "/opt/ml/processing/output/testing", "S3UploadMode": "EndOfJob"}}]}, "NetworkConfig": {"EnableNetworkIsolation": false, "EnableInterContainerTrafficEncryption": true}, "StoppingCondition": {"MaxRuntimeInSeconds": 3000}}, "CacheConfig": {"Enabled": true, "ExpireAfter": "10d"}}, {"Name": "falcon-text-summarization-tuning", "Type": "Training", "Arguments": {"AlgorithmSpecification": {"TrainingInputMode": "File", "TrainingImage": "763104351884.dkr.ecr.us-east-1.amazonaws.com/pytorch-training:2.0.0-cpu-py310-ubuntu20.04-sagemaker"}, "OutputDataConfig": {"S3OutputPath": "s3://sagemaker-us-east-1-327206644775/"}, "StoppingCondition": {"MaxRuntimeInSeconds": 86400}, "ResourceConfig": {"VolumeSizeInGB": 1024, "InstanceCount": 1, "InstanceType": "ml.g5.12xlarge"}, "RoleArn": "arn:aws:iam::327206644775:role/service-role/AmazonSageMaker-ExecutionRole-20221003T003950", "InputDataConfig": [{"DataSource": {"S3DataSource": {"S3DataType": "S3Prefix", "S3Uri": {"Get": "Steps.falcon-text-summarization-preprocess.ProcessingOutputConfig.Outputs['training'].S3Output.S3Uri"}, "S3DataDistributionType": "FullyReplicated"}}, "InputMode": "File", "ChannelName": "falcon-text-summarization-preprocess-training"}, {"DataSource": {"S3DataSource": {"S3DataType": "S3Prefix", "S3Uri": {"Get": "Steps.falcon-text-summarization-preprocess.ProcessingOutputConfig.Outputs['testing'].S3Output.S3Uri"}, "S3DataDistributionType": "FullyReplicated"}}, "InputMode": "File", "ChannelName": "falcon-text-summarization-preprocess-testing"}], "HyperParameters": {"sagemaker_submit_directory": "\"s3://sagemaker-us-east-1-327206644775/calhousing-test/code/3fbcabc20b3e5c7a4186176db6d9b74a/sourcedir.tar.gz\"", "sagemaker_program": "\"training.py\"", "sagemaker_container_log_level": "20", "sagemaker_region": "\"us-east-1\""}, "DebugHookConfig": {"S3OutputPath": "s3://sagemaker-us-east-1-327206644775/", "CollectionConfigurations": []}, "ProfilerConfig": {"S3OutputPath": "s3://sagemaker-us-east-1-327206644775/", "DisableProfiler": false}}, "DependsOn": ["falcon-text-summarization-preprocess"], "CacheConfig": {"Enabled": true, "ExpireAfter": "10d"}}, {"Name": "falcon-text-summarization-register-RegisterModel", "Type": "RegisterModel", "Arguments": {"ModelPackageGroupName": "test-falcon40b-finetuneable", "ModelPackageDescription": "Default Model Package Description. Please add custom descriptioon in your conf.yaml file", "CustomerMetadataProperties": {"PIPELINE_ARN": {"Get": "Execution.PipelineExecutionArn"}}, "InferenceSpecification": {"Containers": [{"Image": "763104351884.dkr.ecr.us-east-1.amazonaws.com/huggingface-pytorch-inference:1.13.1-transformers4.26.0-gpu-py39-cu117-ubuntu20.04", "Environment": {"SAGEMAKER_SUBMIT_DIRECTORY": "/opt/ml/model/code", "SAGEMAKER_PROGRAM": "transform.inference", "SAGEMAKER_REQUIREMENTS": "requirements.txt"}, "ModelDataUrl": {"Get": "Steps.falcon-text-summarization-tuning.ModelArtifacts.S3ModelArtifacts"}}], "SupportedContentTypes": ["application/json"], "SupportedResponseMIMETypes": ["application/json"], "SupportedRealtimeInferenceInstanceTypes": ["ml.m5.2xlarge"], "SupportedTransformInstanceTypes": ["ml.m5.2xlarge"]}, "ModelApprovalStatus": "PendingManualApproval", "SkipModelValidation": "None"}, "DependsOn": ["falcon-text-summarization-tuning"]}, {"Name": "calhousing-Preprocessing", "Type": "Processing", "Arguments": {"ProcessingResources": {"ClusterConfig": {"InstanceType": "ml.m5.2xlarge", "InstanceCount": 1, "VolumeSizeInGB": 32}}, "AppSpecification": {"ImageUri": "683313688378.dkr.ecr.us-east-1.amazonaws.com/sagemaker-scikit-learn:1.2-1-cpu-py3", "ContainerEntrypoint": ["/bin/bash", "/opt/ml/processing/input/entrypoint/runproc.sh"]}, "RoleArn": "arn:aws:iam::327206644775:role/service-role/AmazonSageMaker-ExecutionRole-20221003T003950", "ProcessingInputs": [{"InputName": "raw_data", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-us-east-1-327206644775/tf2-california-housing-pipelines/traindata", "LocalPath": "/opt/ml/processing/input/raw_data", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "code", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-us-east-1-327206644775/calhousing-test/code/601361f018d558aff5f6d5e5aa268a99/sourcedir.tar.gz", "LocalPath": "/opt/ml/processing/input/code/", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "entrypoint", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-us-east-1-327206644775/calhousing-test/code/906d832cb8d78a79db7aca5f0e90b4df/runproc.sh", "LocalPath": "/opt/ml/processing/input/entrypoint", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}], "ProcessingOutputConfig": {"Outputs": [{"OutputName": "train", "AppManaged": false, "S3Output": {"S3Uri": {"Std:Join": {"On": "/", "Values": ["s3:/", "sagemaker-us-east-1-327206644775", "calhousing-test", {"Get": "Execution.PipelineExecutionId"}, "calhousing-Preprocessing", "output", "train"]}}, "LocalPath": "/opt/ml/processing/output/train", "S3UploadMode": "EndOfJob"}}]}, "NetworkConfig": {"EnableNetworkIsolation": false, "EnableInterContainerTrafficEncryption": true}, "StoppingCondition": {"MaxRuntimeInSeconds": 3000}}, "CacheConfig": {"Enabled": true, "ExpireAfter": "10d"}}, {"Name": "calhousing-Training", "Type": "Training", "Arguments": {"AlgorithmSpecification": {"TrainingInputMode": "File", "TrainingImage": "763104351884.dkr.ecr.us-east-1.amazonaws.com/tensorflow-training:2.11.0-cpu-py39"}, "OutputDataConfig": {"S3OutputPath": "s3://sagemaker-us-east-1-327206644775/"}, "StoppingCondition": {"MaxRuntimeInSeconds": 3000}, "ResourceConfig": {"VolumeSizeInGB": 32, "InstanceCount": 1, "InstanceType": "ml.m5.2xlarge"}, "RoleArn": "arn:aws:iam::327206644775:role/service-role/AmazonSageMaker-ExecutionRole-20221003T003950", "InputDataConfig": [{"DataSource": {"S3DataSource": {"S3DataType": "S3Prefix", "S3Uri": {"Get": "Steps.calhousing-Preprocessing.ProcessingOutputConfig.Outputs['train'].S3Output.S3Uri"}, "S3DataDistributionType": "FullyReplicated"}}, "InputMode": "File", "ChannelName": "calhousing-Preprocessing-train"}], "HyperParameters": {"sagemaker_submit_directory": "\"s3://sagemaker-us-east-1-327206644775/calhousing-test/code/2b2bed1653f6e5820c3ed4eac9f4c094/sourcedir.tar.gz\"", "sagemaker_program": "\"train.py\"", "sagemaker_container_log_level": "20", "sagemaker_region": "\"us-east-1\""}, "DebugHookConfig": {"S3OutputPath": "s3://sagemaker-us-east-1-327206644775/", "CollectionConfigurations": []}, "ProfilerConfig": {"S3OutputPath": "s3://sagemaker-us-east-1-327206644775/", "DisableProfiler": false}}, "DependsOn": ["calhousing-Preprocessing"], "CacheConfig": {"Enabled": true, "ExpireAfter": "10d"}}, {"Name": "calhousing-CreateModel-CreateModel", "Type": "Model", "Arguments": {"ExecutionRoleArn": "arn:aws:iam::327206644775:role/service-role/AmazonSageMaker-ExecutionRole-20221003T003950", "PrimaryContainer": {"Image": "763104351884.dkr.ecr.us-east-1.amazonaws.com/tensorflow-inference:2.11.0-cpu", "Environment": {"SAGEMAKER_SUBMIT_DIRECTORY": "/opt/ml/model/code", "SAGEMAKER_PROGRAM": "inference", "SAGEMAKER_REQUIREMENTS": "requirements.txt"}, "ModelDataUrl": {"Get": "Steps.calhousing-Training.ModelArtifacts.S3ModelArtifacts"}}}, "DependsOn": ["calhousing-Training"]}, {"Name": "calhousing-Transform", "Type": "Transform", "Arguments": {"ModelName": {"Get": "Steps.calhousing-CreateModel-CreateModel.ModelName"}, "TransformInput": {"DataSource": {"S3DataSource": {"S3DataType": "S3Prefix", "S3Uri": {"Std:Join": {"On": "/", "Values": [{"Get": "Steps.calhousing-Preprocessing.ProcessingOutputConfig.Outputs['train'].S3Output.S3Uri"}, "test/x_test.csv"]}}}}, "ContentType": "text/csv"}, "TransformOutput": {"S3OutputPath": {"Std:Join": {"On": "/", "Values": ["s3:/", "sagemaker-us-east-1-327206644775", "calhousing-test", {"Get": "Execution.PipelineExecutionId"}, "calhousing-Transform"]}}, "Accept": "text/csv"}, "TransformResources": {"InstanceCount": 1, "InstanceType": "ml.m5.2xlarge"}}, "DependsOn": ["calhousing-CreateModel-CreateModel"], "CacheConfig": {"Enabled": false, "ExpireAfter": "10d"}}, {"Name": "calhousing-Metrics", "Type": "Processing", "Arguments": {"ProcessingResources": {"ClusterConfig": {"InstanceType": "ml.m5.2xlarge", "InstanceCount": 1, "VolumeSizeInGB": 50}}, "AppSpecification": {"ImageUri": "683313688378.dkr.ecr.us-east-1.amazonaws.com/sagemaker-scikit-learn:1.2-1-cpu-py3", "ContainerEntrypoint": ["/bin/bash", "/opt/ml/processing/input/entrypoint/runproc.sh"]}, "RoleArn": "arn:aws:iam::327206644775:role/service-role/AmazonSageMaker-ExecutionRole-20221003T003950", "ProcessingInputs": [{"InputName": "calhousing-Preprocessing-input", "AppManaged": false, "S3Input": {"S3Uri": {"Get": "Steps.calhousing-Preprocessing.ProcessingOutputConfig.Outputs['train'].S3Output.S3Uri"}, "LocalPath": "/opt/ml/processing/input/calhousing-Preprocessing-train", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "calhousing-Transform-input", "AppManaged": false, "S3Input": {"S3Uri": {"Get": "Steps.calhousing-Transform.TransformOutput.S3OutputPath"}, "LocalPath": "/opt/ml/processing/input/calhousing-Transform-train", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "code", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-us-east-1-327206644775/calhousing-test/code/f650f30a4e4548c8e803ea6d1a6df415/sourcedir.tar.gz", "LocalPath": "/opt/ml/processing/input/code/", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "entrypoint", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-us-east-1-327206644775/calhousing-test/code/3fb09322e97ad9af120c0c082586efcb/runproc.sh", "LocalPath": "/opt/ml/processing/input/entrypoint", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}], "ProcessingOutputConfig": {"Outputs": [{"OutputName": "model_evaluation_metrics", "AppManaged": false, "S3Output": {"S3Uri": "s3://sagemaker-us-east-1-327206644775/sklearn-2023-10-20-01-19-23-238/output/model_evaluation_metrics", "LocalPath": "/opt/ml/processing/output/", "S3UploadMode": "EndOfJob"}}]}, "NetworkConfig": {"EnableNetworkIsolation": false, "EnableInterContainerTrafficEncryption": true}, "StoppingCondition": {"MaxRuntimeInSeconds": 3600}}, "DependsOn": ["calhousing-Transform"], "CacheConfig": {"Enabled": false, "ExpireAfter": "10d"}, "PropertyFiles": [{"PropertyFileName": "EvaluationReport", "OutputName": "model_evaluation_metrics", "FilePath": "model_evaluation_metrics.json"}]}, {"Name": "calhousing-Register-RegisterModel", "Type": "RegisterModel", "Arguments": {"ModelPackageGroupName": "test-calhousing", "ModelPackageDescription": "Default Model Package Description. Please add custom descriptioon in your conf.yaml file", "ModelMetrics": {"ModelQuality": {"Statistics": {"ContentType": "application/json", "S3Uri": "s3://sagemaker-us-east-1-327206644775/sklearn-2023-10-20-01-19-23-238/output/model_evaluation_metricsmodel_evaluation_metrics.json"}}, "Bias": {}, "Explainability": {}}, "CustomerMetadataProperties": {"PIPELINE_ARN": {"Get": "Execution.PipelineExecutionArn"}}, "InferenceSpecification": {"Containers": [{"Image": "763104351884.dkr.ecr.us-east-1.amazonaws.com/tensorflow-inference:2.11.0-cpu", "Environment": {"SAGEMAKER_SUBMIT_DIRECTORY": "/opt/ml/model/code", "SAGEMAKER_PROGRAM": "inference", "SAGEMAKER_REQUIREMENTS": "requirements.txt"}, "ModelDataUrl": {"Get": "Steps.calhousing-Training.ModelArtifacts.S3ModelArtifacts"}}], "SupportedContentTypes": ["application/json"], "SupportedResponseMIMETypes": ["application/json"], "SupportedRealtimeInferenceInstanceTypes": ["ml.m5.2xlarge"], "SupportedTransformInstanceTypes": ["ml.m5.2xlarge"]}, "ModelApprovalStatus": "PendingManualApproval", "SkipModelValidation": "None"}, "DependsOn": ["calhousing-Metrics"]}]}